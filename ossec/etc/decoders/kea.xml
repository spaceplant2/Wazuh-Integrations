<decoder name="kea">
  <program_name>kea-dhcp</program_name>
</decoder>

<decoder name="kea-dhcp4-lease">
  <parent>kea</parent>
  <regex>DHCP4_LEASE_ALLOC \[(\S+)\] \[hwaddr=(\S+)\] \[yiaddr=(\S+)\] \[lease-time=(\S+)\]</regex>
  <order>subnet, mac_address, client_ip, lease_time</order>
</decoder>

<decoder name="kea-dhcp4-lease-released">
  <parent>kea</parent>
  <regex>DHCP4_LEASE_RELEASED \[(\S+)\] \[hwaddr=(\S+)\] \[yiaddr=(\S+)\]</regex>
  <order>subnet, mac_address, client_ip</order>
</decoder>

<decoder name="kea-dhcp6-lease">
  <parent>kea</parent>
  <regex>DHCP6_LEASE_ALLOC \[(\S+)\] \[type=(\S+)\] \[iaid=(\S+)\] \[duid=(\S+)\] \[address=(\S+)\]</regex>
  <order>subnet, lease_type, iaid, duid, client_ip</order>
</decoder>

<decoder name="kea-rogue-dhcp">
  <parent>kea</parent>
  <regex>DHCP4_CONFLICT_DETECTED \[(\S+)\] \[address=(\S+)\] \[hwaddr=(\S+)\]</regex>
  <order>subnet, conflict_ip, conflict_mac</order>
</decoder>

<decoder name="kea-errors">
  <parent>kea</parent>
  <regex>DHCP4_(\S+)_FAIL \[(\S+)\] \[hwaddr=(\S+)\] \[msg=(.+)\]</regex>
  <order>error_type, subnet, mac_address, error_message</order>
</decoder>

<decoder name="kea-ha">
  <parent>kea</parent>
  <regex>HA_(\S+) \[partner=(\S+)\] \[state=(\S+)\]</regex>
  <order>ha_event, partner, state</order>
</decoder>
