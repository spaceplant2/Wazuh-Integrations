<!-- OPNsense General Format Decoder -->
<decoder name="opnsense">
  <program_name>^opnsense</program_name>
</decoder>

<!-- Firewall Allow/Block Events -->
<decoder name="opnsense-firewall">
  <parent>opnsense</parent>
  <regex>filterlog: (\d+),,(\S+),(\S+),(\S+),(\S+),,(\S+),(\S+),(\S+),(\S+),(\S+),(\S+),(\S+),,([^,]+),([^,]+)</regex>
  <order>rule_id, subrule_id, anchor, tracker, interface, reason, action, direction, ipv, tos, ecn, ttl, id, offset, flags, protocol_id, protocol</order>
</decoder>

<decoder name="opnsense-firewall-ip">
  <parent>opnsense-firewall</parent>
  <regex>(\S+),(\S+),(\S+),(\S+)</regex>
  <order>src_ip, dst_ip, src_port, dst_port</order>
</decoder>

<!-- DHCP Events -->
<decoder name="opnsense-dhcp">
  <parent>opnsense</parent>
  <regex>dhcpd: DHCP(\S+) for (\S+) from (\S+) via (\S+)</regex>
  <order>dhcp_action, client_ip, mac_address, interface</order>
</decoder>

<!-- Suricata Alerts -->
<decoder name="opnsense-suricata">
  <parent>opnsense</parent>
  <regex>suricata: \[\*\] (.+) \[\*\] (.+) \[\*\] (.+)</regex>
  <order>suricata_signature, src_ip, dst_ip</regex>
</decoder>